"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.BaseCredentials = void 0;
const awscli_compatible_1 = require("./awscli-compatible");
const toolkit_error_1 = require("../../toolkit/toolkit-error");
const sdk_logger_1 = require("./sdk-logger");
const private_1 = require("../io/private");
class BaseCredentials {
    /**
     * Use no base credentials
     *
     * There will be no current account and no current region during synthesis. To
     * successfully deploy with this set of base credentials:
     *
     * - The CDK app must provide concrete accounts and regions during synthesis
     * - Credential plugins must be installed to provide credentials for those
     *   accounts.
     */
    static none() {
        return new class {
            async sdkBaseConfig() {
                return {
                    credentialProvider: () => {
                        throw new toolkit_error_1.AuthenticationError('No credentials available due to BaseCredentials.none()');
                    },
                };
            }
            toString() {
                return 'BaseCredentials.none()';
            }
        };
    }
    /**
     * Obtain base credentials and base region the same way the AWS CLI would
     *
     * Credentials and region will be read from the environment first, falling back
     * to INI files or other sources if available.
     *
     * The profile name is configurable.
     */
    static awsCliCompatible(options = {}) {
        return new class {
            sdkBaseConfig(ioHost, clientConfig) {
                const ioHelper = private_1.IoHelper.fromActionAwareIoHost(ioHost);
                const awsCli = new awscli_compatible_1.AwsCliCompatible(ioHelper, clientConfig.requestHandler ?? {}, new sdk_logger_1.IoHostSdkLogger(ioHelper));
                return awsCli.baseConfig(options.profile);
            }
            toString() {
                return `BaseCredentials.awsCliCompatible(${JSON.stringify(options)})`;
            }
        };
    }
    /**
     * Use a custom SDK identity provider for the base credentials
     *
     * If your provider uses STS calls to obtain base credentials, you must make
     * sure to also configure the necessary HTTP options (like proxy and user
     * agent) and the region on the STS client directly; the toolkit code cannot
     * do this for you.
     */
    static custom(options) {
        return new class {
            sdkBaseConfig() {
                return Promise.resolve({
                    credentialProvider: options.provider,
                    defaultRegion: options.region,
                });
            }
            toString() {
                return `BaseCredentials.custom(${JSON.stringify({
                    ...options,
                    provider: '...',
                })})`;
            }
        };
    }
}
exports.BaseCredentials = BaseCredentials;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYmFzZS1jcmVkZW50aWFscy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbImJhc2UtY3JlZGVudGlhbHMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7O0FBR0EsMkRBQXVEO0FBQ3ZELCtEQUFrRTtBQUVsRSw2Q0FBK0M7QUFDL0MsMkNBQXlDO0FBa0R6QyxNQUFhLGVBQWU7SUFDMUI7Ozs7Ozs7OztPQVNHO0lBQ0ksTUFBTSxDQUFDLElBQUk7UUFDaEIsT0FBTyxJQUFJO1lBQ0YsS0FBSyxDQUFDLGFBQWE7Z0JBQ3hCLE9BQU87b0JBQ0wsa0JBQWtCLEVBQUUsR0FBRyxFQUFFO3dCQUN2QixNQUFNLElBQUksbUNBQW1CLENBQUMsd0RBQXdELENBQUMsQ0FBQztvQkFDMUYsQ0FBQztpQkFDRixDQUFDO1lBQ0osQ0FBQztZQUVNLFFBQVE7Z0JBQ2IsT0FBTyx3QkFBd0IsQ0FBQztZQUNsQyxDQUFDO1NBQ0YsQ0FBQztJQUNKLENBQUM7SUFFRDs7Ozs7OztPQU9HO0lBQ0ksTUFBTSxDQUFDLGdCQUFnQixDQUFDLFVBQW1DLEVBQUU7UUFDbEUsT0FBTyxJQUFJO1lBQ0YsYUFBYSxDQUFDLE1BQTBCLEVBQUUsWUFBaUM7Z0JBQ2hGLE1BQU0sUUFBUSxHQUFHLGtCQUFRLENBQUMscUJBQXFCLENBQUMsTUFBTSxDQUFDLENBQUM7Z0JBQ3hELE1BQU0sTUFBTSxHQUFHLElBQUksb0NBQWdCLENBQUMsUUFBUSxFQUFFLFlBQVksQ0FBQyxjQUFjLElBQUksRUFBRSxFQUFFLElBQUksNEJBQWUsQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDO2dCQUNoSCxPQUFPLE1BQU0sQ0FBQyxVQUFVLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxDQUFDO1lBQzVDLENBQUM7WUFFTSxRQUFRO2dCQUNiLE9BQU8sb0NBQW9DLElBQUksQ0FBQyxTQUFTLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQztZQUN4RSxDQUFDO1NBQ0YsQ0FBQztJQUNKLENBQUM7SUFFRDs7Ozs7OztPQU9HO0lBQ0ksTUFBTSxDQUFDLE1BQU0sQ0FBQyxPQUFvQztRQUN2RCxPQUFPLElBQUk7WUFDRixhQUFhO2dCQUNsQixPQUFPLE9BQU8sQ0FBQyxPQUFPLENBQUM7b0JBQ3JCLGtCQUFrQixFQUFFLE9BQU8sQ0FBQyxRQUFRO29CQUNwQyxhQUFhLEVBQUUsT0FBTyxDQUFDLE1BQU07aUJBQzlCLENBQUMsQ0FBQztZQUNMLENBQUM7WUFFTSxRQUFRO2dCQUNiLE9BQU8sMEJBQTBCLElBQUksQ0FBQyxTQUFTLENBQUM7b0JBQzlDLEdBQUcsT0FBTztvQkFDVixRQUFRLEVBQUUsS0FBSztpQkFDaEIsQ0FBQyxHQUFHLENBQUM7WUFDUixDQUFDO1NBQ0YsQ0FBQztJQUNKLENBQUM7Q0FDRjtBQTFFRCwwQ0EwRUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgdHlwZSAqIGFzIGh0dHAgZnJvbSAnbm9kZTpodHRwJztcbmltcG9ydCB0eXBlICogYXMgaHR0cHMgZnJvbSAnbm9kZTpodHRwcyc7XG5pbXBvcnQgdHlwZSB7IFNES3YzQ29tcGF0aWJsZUNyZWRlbnRpYWxQcm92aWRlciB9IGZyb20gJ0Bhd3MtY2RrL2NsaS1wbHVnaW4tY29udHJhY3QnO1xuaW1wb3J0IHsgQXdzQ2xpQ29tcGF0aWJsZSB9IGZyb20gJy4vYXdzY2xpLWNvbXBhdGlibGUnO1xuaW1wb3J0IHsgQXV0aGVudGljYXRpb25FcnJvciB9IGZyb20gJy4uLy4uL3Rvb2xraXQvdG9vbGtpdC1lcnJvcic7XG5pbXBvcnQgdHlwZSB7IElBY3Rpb25Bd2FyZUlvSG9zdCB9IGZyb20gJy4uL2lvJztcbmltcG9ydCB7IElvSG9zdFNka0xvZ2dlciB9IGZyb20gJy4vc2RrLWxvZ2dlcic7XG5pbXBvcnQgeyBJb0hlbHBlciB9IGZyb20gJy4uL2lvL3ByaXZhdGUnO1xuXG4vKipcbiAqIFNldHRpbmdzIGZvciB0aGUgcmVxdWVzdCBoYW5kbGVcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBSZXF1ZXN0SGFuZGxlclNldHRpbmdzIHtcbiAgLyoqXG4gICAqIFRoZSBtYXhpbXVtIHRpbWUgaW4gbWlsbGlzZWNvbmRzIHRoYXQgdGhlIGNvbm5lY3Rpb24gcGhhc2Ugb2YgYSByZXF1ZXN0XG4gICAqIG1heSB0YWtlIGJlZm9yZSB0aGUgY29ubmVjdGlvbiBhdHRlbXB0IGlzIGFiYW5kb25lZC5cbiAgICpcbiAgICogRGVmYXVsdHMgdG8gMCwgd2hpY2ggZGlzYWJsZXMgdGhlIHRpbWVvdXQuXG4gICAqL1xuICBjb25uZWN0aW9uVGltZW91dD86IG51bWJlcjtcbiAgLyoqXG4gICAqIFRoZSBudW1iZXIgb2YgbWlsbGlzZWNvbmRzIGEgcmVxdWVzdCBjYW4gdGFrZSBiZWZvcmUgYXV0b21hdGljYWxseSBiZWluZyB0ZXJtaW5hdGVkLlxuICAgKiBEZWZhdWx0cyB0byAwLCB3aGljaCBkaXNhYmxlcyB0aGUgdGltZW91dC5cbiAgICovXG4gIHJlcXVlc3RUaW1lb3V0PzogbnVtYmVyO1xuICAvKipcbiAgICogQW4gaHR0cC5BZ2VudCB0byBiZSB1c2VkXG4gICAqL1xuICBodHRwQWdlbnQ/OiBodHRwLkFnZW50O1xuICAvKipcbiAgICogQW4gaHR0cHMuQWdlbnQgdG8gYmUgdXNlZFxuICAgKi9cbiAgaHR0cHNBZ2VudD86IGh0dHBzLkFnZW50O1xufVxuXG4vKipcbiAqIEFuIFNESyBjb25maWcgdGhhdFxuICovXG5leHBvcnQgaW50ZXJmYWNlIFNka0Jhc2VDb25maWcge1xuICAvKipcbiAgICogVGhlIGNyZWRlbnRpYWwgcHJvdmlkZXIgdG8gdXNlIGZvciBTREsgY2FsbHMuXG4gICAqL1xuICByZWFkb25seSBjcmVkZW50aWFsUHJvdmlkZXI6IFNES3YzQ29tcGF0aWJsZUNyZWRlbnRpYWxQcm92aWRlcjtcbiAgLyoqXG4gICAqIFRoZSBkZWZhdWx0IHJlZ2lvbiB0byB1c2UgZm9yIFNESyBjYWxscy5cbiAgICovXG4gIHJlYWRvbmx5IGRlZmF1bHRSZWdpb24/OiBzdHJpbmc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgU2RrQmFzZUNsaWVudENvbmZpZyB7XG4gIHJlcXVlc3RIYW5kbGVyPzogUmVxdWVzdEhhbmRsZXJTZXR0aW5ncztcbn1cblxuZXhwb3J0IGludGVyZmFjZSBJQmFzZUNyZWRlbnRpYWxzUHJvdmlkZXIge1xuICBzZGtCYXNlQ29uZmlnKGlvSG9zdDogSUFjdGlvbkF3YXJlSW9Ib3N0LCBjbGllbnRDb25maWc6IFNka0Jhc2VDbGllbnRDb25maWcpOiBQcm9taXNlPFNka0Jhc2VDb25maWc+O1xufVxuXG5leHBvcnQgY2xhc3MgQmFzZUNyZWRlbnRpYWxzIHtcbiAgLyoqXG4gICAqIFVzZSBubyBiYXNlIGNyZWRlbnRpYWxzXG4gICAqXG4gICAqIFRoZXJlIHdpbGwgYmUgbm8gY3VycmVudCBhY2NvdW50IGFuZCBubyBjdXJyZW50IHJlZ2lvbiBkdXJpbmcgc3ludGhlc2lzLiBUb1xuICAgKiBzdWNjZXNzZnVsbHkgZGVwbG95IHdpdGggdGhpcyBzZXQgb2YgYmFzZSBjcmVkZW50aWFsczpcbiAgICpcbiAgICogLSBUaGUgQ0RLIGFwcCBtdXN0IHByb3ZpZGUgY29uY3JldGUgYWNjb3VudHMgYW5kIHJlZ2lvbnMgZHVyaW5nIHN5bnRoZXNpc1xuICAgKiAtIENyZWRlbnRpYWwgcGx1Z2lucyBtdXN0IGJlIGluc3RhbGxlZCB0byBwcm92aWRlIGNyZWRlbnRpYWxzIGZvciB0aG9zZVxuICAgKiAgIGFjY291bnRzLlxuICAgKi9cbiAgcHVibGljIHN0YXRpYyBub25lKCk6IElCYXNlQ3JlZGVudGlhbHNQcm92aWRlciB7XG4gICAgcmV0dXJuIG5ldyBjbGFzcyBpbXBsZW1lbnRzIElCYXNlQ3JlZGVudGlhbHNQcm92aWRlciB7XG4gICAgICBwdWJsaWMgYXN5bmMgc2RrQmFzZUNvbmZpZygpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBjcmVkZW50aWFsUHJvdmlkZXI6ICgpID0+IHtcbiAgICAgICAgICAgIHRocm93IG5ldyBBdXRoZW50aWNhdGlvbkVycm9yKCdObyBjcmVkZW50aWFscyBhdmFpbGFibGUgZHVlIHRvIEJhc2VDcmVkZW50aWFscy5ub25lKCknKTtcbiAgICAgICAgICB9LFxuICAgICAgICB9O1xuICAgICAgfVxuXG4gICAgICBwdWJsaWMgdG9TdHJpbmcoKSB7XG4gICAgICAgIHJldHVybiAnQmFzZUNyZWRlbnRpYWxzLm5vbmUoKSc7XG4gICAgICB9XG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBPYnRhaW4gYmFzZSBjcmVkZW50aWFscyBhbmQgYmFzZSByZWdpb24gdGhlIHNhbWUgd2F5IHRoZSBBV1MgQ0xJIHdvdWxkXG4gICAqXG4gICAqIENyZWRlbnRpYWxzIGFuZCByZWdpb24gd2lsbCBiZSByZWFkIGZyb20gdGhlIGVudmlyb25tZW50IGZpcnN0LCBmYWxsaW5nIGJhY2tcbiAgICogdG8gSU5JIGZpbGVzIG9yIG90aGVyIHNvdXJjZXMgaWYgYXZhaWxhYmxlLlxuICAgKlxuICAgKiBUaGUgcHJvZmlsZSBuYW1lIGlzIGNvbmZpZ3VyYWJsZS5cbiAgICovXG4gIHB1YmxpYyBzdGF0aWMgYXdzQ2xpQ29tcGF0aWJsZShvcHRpb25zOiBBd3NDbGlDb21wYXRpYmxlT3B0aW9ucyA9IHt9KTogSUJhc2VDcmVkZW50aWFsc1Byb3ZpZGVyIHtcbiAgICByZXR1cm4gbmV3IGNsYXNzIGltcGxlbWVudHMgSUJhc2VDcmVkZW50aWFsc1Byb3ZpZGVyIHtcbiAgICAgIHB1YmxpYyBzZGtCYXNlQ29uZmlnKGlvSG9zdDogSUFjdGlvbkF3YXJlSW9Ib3N0LCBjbGllbnRDb25maWc6IFNka0Jhc2VDbGllbnRDb25maWcpIHtcbiAgICAgICAgY29uc3QgaW9IZWxwZXIgPSBJb0hlbHBlci5mcm9tQWN0aW9uQXdhcmVJb0hvc3QoaW9Ib3N0KTtcbiAgICAgICAgY29uc3QgYXdzQ2xpID0gbmV3IEF3c0NsaUNvbXBhdGlibGUoaW9IZWxwZXIsIGNsaWVudENvbmZpZy5yZXF1ZXN0SGFuZGxlciA/PyB7fSwgbmV3IElvSG9zdFNka0xvZ2dlcihpb0hlbHBlcikpO1xuICAgICAgICByZXR1cm4gYXdzQ2xpLmJhc2VDb25maWcob3B0aW9ucy5wcm9maWxlKTtcbiAgICAgIH1cblxuICAgICAgcHVibGljIHRvU3RyaW5nKCkge1xuICAgICAgICByZXR1cm4gYEJhc2VDcmVkZW50aWFscy5hd3NDbGlDb21wYXRpYmxlKCR7SlNPTi5zdHJpbmdpZnkob3B0aW9ucyl9KWA7XG4gICAgICB9XG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBVc2UgYSBjdXN0b20gU0RLIGlkZW50aXR5IHByb3ZpZGVyIGZvciB0aGUgYmFzZSBjcmVkZW50aWFsc1xuICAgKlxuICAgKiBJZiB5b3VyIHByb3ZpZGVyIHVzZXMgU1RTIGNhbGxzIHRvIG9idGFpbiBiYXNlIGNyZWRlbnRpYWxzLCB5b3UgbXVzdCBtYWtlXG4gICAqIHN1cmUgdG8gYWxzbyBjb25maWd1cmUgdGhlIG5lY2Vzc2FyeSBIVFRQIG9wdGlvbnMgKGxpa2UgcHJveHkgYW5kIHVzZXJcbiAgICogYWdlbnQpIGFuZCB0aGUgcmVnaW9uIG9uIHRoZSBTVFMgY2xpZW50IGRpcmVjdGx5OyB0aGUgdG9vbGtpdCBjb2RlIGNhbm5vdFxuICAgKiBkbyB0aGlzIGZvciB5b3UuXG4gICAqL1xuICBwdWJsaWMgc3RhdGljIGN1c3RvbShvcHRpb25zOiBDdXN0b21CYXNlQ3JlZGVudGlhbHNPcHRpb24pOiBJQmFzZUNyZWRlbnRpYWxzUHJvdmlkZXIge1xuICAgIHJldHVybiBuZXcgY2xhc3MgaW1wbGVtZW50cyBJQmFzZUNyZWRlbnRpYWxzUHJvdmlkZXIge1xuICAgICAgcHVibGljIHNka0Jhc2VDb25maWcoKTogUHJvbWlzZTxTZGtCYXNlQ29uZmlnPiB7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoe1xuICAgICAgICAgIGNyZWRlbnRpYWxQcm92aWRlcjogb3B0aW9ucy5wcm92aWRlcixcbiAgICAgICAgICBkZWZhdWx0UmVnaW9uOiBvcHRpb25zLnJlZ2lvbixcbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIHB1YmxpYyB0b1N0cmluZygpIHtcbiAgICAgICAgcmV0dXJuIGBCYXNlQ3JlZGVudGlhbHMuY3VzdG9tKCR7SlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgIC4uLm9wdGlvbnMsXG4gICAgICAgICAgcHJvdmlkZXI6ICcuLi4nLFxuICAgICAgICB9KX0pYDtcbiAgICAgIH1cbiAgICB9O1xuICB9XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQXdzQ2xpQ29tcGF0aWJsZU9wdGlvbnMge1xuICAvKipcbiAgICogVGhlIHByb2ZpbGUgdG8gcmVhZCBmcm9tIGB+Ly5hd3MvY3JlZGVudGlhbHNgLlxuICAgKlxuICAgKiBJZiBub3Qgc3VwcGxpZWQgdGhlIGVudmlyb25tZW50IHZhcmlhYmxlIEFXU19QUk9GSUxFIHdpbGwgYmUgdXNlZC5cbiAgICpcbiAgICogQGRlZmF1bHQgLSBVc2UgZW52aXJvbm1lbnQgdmFyaWFibGUgaWYgc2V0LlxuICAgKi9cbiAgcmVhZG9ubHkgcHJvZmlsZT86IHN0cmluZztcbn1cblxuZXhwb3J0IGludGVyZmFjZSBDdXN0b21CYXNlQ3JlZGVudGlhbHNPcHRpb24ge1xuICAvKipcbiAgICogVGhlIGNyZWRlbnRpYWxzIHByb3ZpZGVyIHRvIHVzZSB0byBvYnRhaW4gYmFzZSBjcmVkZW50aWFsc1xuICAgKlxuICAgKiBJZiB5b3VyIHByb3ZpZGVyIHVzZXMgU1RTIGNhbGxzIHRvIG9idGFpbiBiYXNlIGNyZWRlbnRpYWxzLCB5b3UgbXVzdCBtYWtlXG4gICAqIHN1cmUgdG8gYWxzbyBjb25maWd1cmUgdGhlIG5lY2Vzc2FyeSBIVFRQIG9wdGlvbnMgKGxpa2UgcHJveHkgYW5kIHVzZXJcbiAgICogYWdlbnQpIG9uIHRoZSBTVFMgY2xpZW50IGRpcmVjdGx5OyB0aGUgdG9vbGtpdCBjb2RlIGNhbm5vdCBkbyB0aGlzIGZvciB5b3UuXG4gICAqL1xuICByZWFkb25seSBwcm92aWRlcjogU0RLdjNDb21wYXRpYmxlQ3JlZGVudGlhbFByb3ZpZGVyO1xuXG4gIC8qKlxuICAgKiBUaGUgZGVmYXVsdCByZWdpb24gdG8gc3ludGhlc2l6ZSBmb3JcbiAgICpcbiAgICogQ0RLIGFwcGxpY2F0aW9ucyBjYW4gb3ZlcnJpZGUgdGhpcyByZWdpb24uIE5PVEU6IHRoaXMgcmVnaW9uIHdpbGwgKm5vdCpcbiAgICogYWZmZWN0IGFueSBTVFMgY2FsbHMgbWFkZSBieSB0aGUgZ2l2ZW4gcHJvdmlkZXIsIGlmIGFueS4gWW91IG5lZWQgdG8gY29uZmlndXJlXG4gICAqIHlvdXIgY3JlZGVudGlhbCBwcm92aWRlciBzZXBhcmF0ZWx5LlxuICAgKlxuICAgKiBAZGVmYXVsdCAndXMtZWFzdC0xJ1xuICAgKi9cbiAgcmVhZG9ubHkgcmVnaW9uPzogc3RyaW5nO1xufVxuIl19