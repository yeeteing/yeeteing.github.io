/**
 * A function resource acceptor.
 */
export class FunctionResourceAccessAcceptor {
    func;
    functionEnvironmentTranslator;
    identifier;
    /**
     * Creates function resource acceptor.
     */
    constructor(func, functionEnvironmentTranslator) {
        this.func = func;
        this.functionEnvironmentTranslator = functionEnvironmentTranslator;
        this.identifier = `${func.node.id}LambdaResourceAccessAcceptor`;
    }
    acceptResourceAccess = (policy, ssmEnvironmentEntries) => {
        const role = this.func.resources.lambda.role;
        if (!role) {
            // This should never happen since we are using the Function L2 construct
            throw new Error('No execution role found to attach lambda permissions to');
        }
        policy.attachToRole(role);
        if (this.functionEnvironmentTranslator) {
            for (const { name, path } of ssmEnvironmentEntries) {
                this.functionEnvironmentTranslator.addSsmEnvironmentEntry(name, path);
            }
        }
    };
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicmVzb3VyY2VfYWNjZXNzX2FjY2VwdG9yLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vc3JjL3Jlc291cmNlX2FjY2Vzc19hY2NlcHRvci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFRQTs7R0FFRztBQUNILE1BQU0sT0FBTyw4QkFBOEI7SUFPdEI7SUFDQTtJQVBWLFVBQVUsQ0FBUztJQUU1Qjs7T0FFRztJQUNILFlBQ21CLElBQXlCLEVBQ3pCLDZCQUE2RDtRQUQ3RCxTQUFJLEdBQUosSUFBSSxDQUFxQjtRQUN6QixrQ0FBNkIsR0FBN0IsNkJBQTZCLENBQWdDO1FBRTlFLElBQUksQ0FBQyxVQUFVLEdBQUcsR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLEVBQUUsOEJBQThCLENBQUM7SUFDbEUsQ0FBQztJQUVELG9CQUFvQixHQUFHLENBQ3JCLE1BQWMsRUFDZCxxQkFBNEMsRUFDNUMsRUFBRTtRQUNGLE1BQU0sSUFBSSxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUM7UUFDN0MsSUFBSSxDQUFDLElBQUksRUFBRSxDQUFDO1lBQ1Ysd0VBQXdFO1lBQ3hFLE1BQU0sSUFBSSxLQUFLLENBQ2IseURBQXlELENBQzFELENBQUM7UUFDSixDQUFDO1FBQ0QsTUFBTSxDQUFDLFlBQVksQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUMxQixJQUFJLElBQUksQ0FBQyw2QkFBNkIsRUFBRSxDQUFDO1lBQ3ZDLEtBQUssTUFBTSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxxQkFBcUIsRUFBRSxDQUFDO2dCQUNuRCxJQUFJLENBQUMsNkJBQTZCLENBQUMsc0JBQXNCLENBQUMsSUFBSSxFQUFFLElBQUksQ0FBQyxDQUFDO1lBQ3hFLENBQUM7UUFDSCxDQUFDO0lBQ0gsQ0FBQyxDQUFDO0NBQ0giLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xuICBSZXNvdXJjZUFjY2Vzc0FjY2VwdG9yLFxuICBTc21FbnZpcm9ubWVudEVudHJ5LFxufSBmcm9tICdAYXdzLWFtcGxpZnkvcGx1Z2luLXR5cGVzJztcbmltcG9ydCB7IEZ1bmN0aW9uRW52aXJvbm1lbnRUcmFuc2xhdG9yIH0gZnJvbSAnLi9mdW5jdGlvbl9lbnZfdHJhbnNsYXRvci5qcyc7XG5pbXBvcnQgeyBBbXBsaWZ5RnVuY3Rpb25CYXNlIH0gZnJvbSAnLi9mdW5jdGlvbl9jb25zdHJ1Y3RfYmFzZS5qcyc7XG5pbXBvcnQgeyBQb2xpY3kgfSBmcm9tICdhd3MtY2RrLWxpYi9hd3MtaWFtJztcblxuLyoqXG4gKiBBIGZ1bmN0aW9uIHJlc291cmNlIGFjY2VwdG9yLlxuICovXG5leHBvcnQgY2xhc3MgRnVuY3Rpb25SZXNvdXJjZUFjY2Vzc0FjY2VwdG9yIGltcGxlbWVudHMgUmVzb3VyY2VBY2Nlc3NBY2NlcHRvciB7XG4gIHJlYWRvbmx5IGlkZW50aWZpZXI6IHN0cmluZztcblxuICAvKipcbiAgICogQ3JlYXRlcyBmdW5jdGlvbiByZXNvdXJjZSBhY2NlcHRvci5cbiAgICovXG4gIGNvbnN0cnVjdG9yKFxuICAgIHByaXZhdGUgcmVhZG9ubHkgZnVuYzogQW1wbGlmeUZ1bmN0aW9uQmFzZSxcbiAgICBwcml2YXRlIHJlYWRvbmx5IGZ1bmN0aW9uRW52aXJvbm1lbnRUcmFuc2xhdG9yPzogRnVuY3Rpb25FbnZpcm9ubWVudFRyYW5zbGF0b3IsXG4gICkge1xuICAgIHRoaXMuaWRlbnRpZmllciA9IGAke2Z1bmMubm9kZS5pZH1MYW1iZGFSZXNvdXJjZUFjY2Vzc0FjY2VwdG9yYDtcbiAgfVxuXG4gIGFjY2VwdFJlc291cmNlQWNjZXNzID0gKFxuICAgIHBvbGljeTogUG9saWN5LFxuICAgIHNzbUVudmlyb25tZW50RW50cmllczogU3NtRW52aXJvbm1lbnRFbnRyeVtdLFxuICApID0+IHtcbiAgICBjb25zdCByb2xlID0gdGhpcy5mdW5jLnJlc291cmNlcy5sYW1iZGEucm9sZTtcbiAgICBpZiAoIXJvbGUpIHtcbiAgICAgIC8vIFRoaXMgc2hvdWxkIG5ldmVyIGhhcHBlbiBzaW5jZSB3ZSBhcmUgdXNpbmcgdGhlIEZ1bmN0aW9uIEwyIGNvbnN0cnVjdFxuICAgICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgICAnTm8gZXhlY3V0aW9uIHJvbGUgZm91bmQgdG8gYXR0YWNoIGxhbWJkYSBwZXJtaXNzaW9ucyB0bycsXG4gICAgICApO1xuICAgIH1cbiAgICBwb2xpY3kuYXR0YWNoVG9Sb2xlKHJvbGUpO1xuICAgIGlmICh0aGlzLmZ1bmN0aW9uRW52aXJvbm1lbnRUcmFuc2xhdG9yKSB7XG4gICAgICBmb3IgKGNvbnN0IHsgbmFtZSwgcGF0aCB9IG9mIHNzbUVudmlyb25tZW50RW50cmllcykge1xuICAgICAgICB0aGlzLmZ1bmN0aW9uRW52aXJvbm1lbnRUcmFuc2xhdG9yLmFkZFNzbUVudmlyb25tZW50RW50cnkobmFtZSwgcGF0aCk7XG4gICAgICB9XG4gICAgfVxuICB9O1xufVxuIl19