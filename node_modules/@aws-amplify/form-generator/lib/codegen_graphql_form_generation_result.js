import path from 'path';
import fs from 'fs/promises';
/**
 * Encapsulates a result from a call to the codegen form generation service
 */
export class CodegenGraphqlFormGeneratorResult {
    fileNameComponentMap;
    /**
     * Creates a CodegenGraphqlFormGeneratorResponse
     */
    constructor(fileNameComponentMap) {
        this.fileNameComponentMap = fileNameComponentMap;
    }
    /**
     * writes the components to a given directory
     */
    writeToDirectory = async (directoryPath) => {
        const filesWritten = [];
        try {
            await fs.stat(directoryPath);
        }
        catch {
            await fs.mkdir(directoryPath);
        }
        for (const [fileName, content] of Object.entries(this.fileNameComponentMap)) {
            if (content) {
                const filePath = path.join(directoryPath, fileName);
                const fd = await fs.open(filePath, 'w+');
                try {
                    await fd.writeFile(content);
                    filesWritten.push(path.relative(process.cwd(), filePath));
                }
                finally {
                    await fd.close();
                }
            }
        }
        return { filesWritten };
    };
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29kZWdlbl9ncmFwaHFsX2Zvcm1fZ2VuZXJhdGlvbl9yZXN1bHQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi9zcmMvY29kZWdlbl9ncmFwaHFsX2Zvcm1fZ2VuZXJhdGlvbl9yZXN1bHQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxJQUFJLE1BQU0sTUFBTSxDQUFDO0FBQ3hCLE9BQU8sRUFBRSxNQUFNLGFBQWEsQ0FBQztBQUc3Qjs7R0FFRztBQUNILE1BQU0sT0FBTyxpQ0FBaUM7SUFNZjtJQUg3Qjs7T0FFRztJQUNILFlBQTZCLG9CQUE0QztRQUE1Qyx5QkFBb0IsR0FBcEIsb0JBQW9CLENBQXdCO0lBQUcsQ0FBQztJQUM3RTs7T0FFRztJQUNILGdCQUFnQixHQUFHLEtBQUssRUFBRSxhQUFxQixFQUFFLEVBQUU7UUFDakQsTUFBTSxZQUFZLEdBQWEsRUFBRSxDQUFDO1FBRWxDLElBQUksQ0FBQztZQUNILE1BQU0sRUFBRSxDQUFDLElBQUksQ0FBQyxhQUFhLENBQUMsQ0FBQztRQUMvQixDQUFDO1FBQUMsTUFBTSxDQUFDO1lBQ1AsTUFBTSxFQUFFLENBQUMsS0FBSyxDQUFDLGFBQWEsQ0FBQyxDQUFDO1FBQ2hDLENBQUM7UUFDRCxLQUFLLE1BQU0sQ0FBQyxRQUFRLEVBQUUsT0FBTyxDQUFDLElBQUksTUFBTSxDQUFDLE9BQU8sQ0FDOUMsSUFBSSxDQUFDLG9CQUFvQixDQUMxQixFQUFFLENBQUM7WUFDRixJQUFJLE9BQU8sRUFBRSxDQUFDO2dCQUNaLE1BQU0sUUFBUSxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsYUFBYSxFQUFFLFFBQVEsQ0FBQyxDQUFDO2dCQUNwRCxNQUFNLEVBQUUsR0FBRyxNQUFNLEVBQUUsQ0FBQyxJQUFJLENBQUMsUUFBUSxFQUFFLElBQUksQ0FBQyxDQUFDO2dCQUN6QyxJQUFJLENBQUM7b0JBQ0gsTUFBTSxFQUFFLENBQUMsU0FBUyxDQUFDLE9BQU8sQ0FBQyxDQUFDO29CQUM1QixZQUFZLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsT0FBTyxDQUFDLEdBQUcsRUFBRSxFQUFFLFFBQVEsQ0FBQyxDQUFDLENBQUM7Z0JBQzVELENBQUM7d0JBQVMsQ0FBQztvQkFDVCxNQUFNLEVBQUUsQ0FBQyxLQUFLLEVBQUUsQ0FBQztnQkFDbkIsQ0FBQztZQUNILENBQUM7UUFDSCxDQUFDO1FBRUQsT0FBTyxFQUFFLFlBQVksRUFBRSxDQUFDO0lBQzFCLENBQUMsQ0FBQztDQUNIIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHBhdGggZnJvbSAncGF0aCc7XG5pbXBvcnQgZnMgZnJvbSAnZnMvcHJvbWlzZXMnO1xuaW1wb3J0IHsgR3JhcGhxbEdlbmVyYXRpb25SZXN1bHQgfSBmcm9tICcuL2dyYXBocWxfZm9ybV9nZW5lcmF0b3IuanMnO1xuXG4vKipcbiAqIEVuY2Fwc3VsYXRlcyBhIHJlc3VsdCBmcm9tIGEgY2FsbCB0byB0aGUgY29kZWdlbiBmb3JtIGdlbmVyYXRpb24gc2VydmljZVxuICovXG5leHBvcnQgY2xhc3MgQ29kZWdlbkdyYXBocWxGb3JtR2VuZXJhdG9yUmVzdWx0XG4gIGltcGxlbWVudHMgR3JhcGhxbEdlbmVyYXRpb25SZXN1bHRcbntcbiAgLyoqXG4gICAqIENyZWF0ZXMgYSBDb2RlZ2VuR3JhcGhxbEZvcm1HZW5lcmF0b3JSZXNwb25zZVxuICAgKi9cbiAgY29uc3RydWN0b3IocHJpdmF0ZSByZWFkb25seSBmaWxlTmFtZUNvbXBvbmVudE1hcDogUmVjb3JkPHN0cmluZywgc3RyaW5nPikge31cbiAgLyoqXG4gICAqIHdyaXRlcyB0aGUgY29tcG9uZW50cyB0byBhIGdpdmVuIGRpcmVjdG9yeVxuICAgKi9cbiAgd3JpdGVUb0RpcmVjdG9yeSA9IGFzeW5jIChkaXJlY3RvcnlQYXRoOiBzdHJpbmcpID0+IHtcbiAgICBjb25zdCBmaWxlc1dyaXR0ZW46IHN0cmluZ1tdID0gW107XG5cbiAgICB0cnkge1xuICAgICAgYXdhaXQgZnMuc3RhdChkaXJlY3RvcnlQYXRoKTtcbiAgICB9IGNhdGNoIHtcbiAgICAgIGF3YWl0IGZzLm1rZGlyKGRpcmVjdG9yeVBhdGgpO1xuICAgIH1cbiAgICBmb3IgKGNvbnN0IFtmaWxlTmFtZSwgY29udGVudF0gb2YgT2JqZWN0LmVudHJpZXMoXG4gICAgICB0aGlzLmZpbGVOYW1lQ29tcG9uZW50TWFwLFxuICAgICkpIHtcbiAgICAgIGlmIChjb250ZW50KSB7XG4gICAgICAgIGNvbnN0IGZpbGVQYXRoID0gcGF0aC5qb2luKGRpcmVjdG9yeVBhdGgsIGZpbGVOYW1lKTtcbiAgICAgICAgY29uc3QgZmQgPSBhd2FpdCBmcy5vcGVuKGZpbGVQYXRoLCAndysnKTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBhd2FpdCBmZC53cml0ZUZpbGUoY29udGVudCk7XG4gICAgICAgICAgZmlsZXNXcml0dGVuLnB1c2gocGF0aC5yZWxhdGl2ZShwcm9jZXNzLmN3ZCgpLCBmaWxlUGF0aCkpO1xuICAgICAgICB9IGZpbmFsbHkge1xuICAgICAgICAgIGF3YWl0IGZkLmNsb3NlKCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4geyBmaWxlc1dyaXR0ZW4gfTtcbiAgfTtcbn1cbiJdfQ==