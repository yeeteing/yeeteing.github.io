import { CDKContextKey } from '@aws-amplify/platform-core';
/**
 * Populates a backend identifier based on CDK context values.
 */
export const getBackendIdentifier = (scope) => {
    const backendNamespace = scope.node.getContext(CDKContextKey.BACKEND_NAMESPACE);
    if (typeof backendNamespace !== 'string') {
        throw new Error(`${CDKContextKey.BACKEND_NAMESPACE} CDK context value is not a string`);
    }
    const backendName = scope.node.getContext(CDKContextKey.BACKEND_NAME);
    if (typeof backendName !== 'string') {
        throw new Error(`${CDKContextKey.BACKEND_NAME} CDK context value is not a string`);
    }
    const deploymentType = scope.node.getContext(CDKContextKey.DEPLOYMENT_TYPE);
    const expectedDeploymentTypeValues = ['sandbox', 'branch'];
    if (!expectedDeploymentTypeValues.includes(deploymentType)) {
        throw new Error(`${CDKContextKey.DEPLOYMENT_TYPE} CDK context value is not in (${expectedDeploymentTypeValues.join(', ')})`);
    }
    return {
        type: deploymentType,
        namespace: backendNamespace,
        name: backendName,
    };
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYmFja2VuZF9pZGVudGlmaWVyLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vc3JjL2JhY2tlbmRfaWRlbnRpZmllci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFDQSxPQUFPLEVBQUUsYUFBYSxFQUFFLE1BQU0sNEJBQTRCLENBQUM7QUFHM0Q7O0dBRUc7QUFDSCxNQUFNLENBQUMsTUFBTSxvQkFBb0IsR0FBRyxDQUFDLEtBQWdCLEVBQXFCLEVBQUU7SUFDMUUsTUFBTSxnQkFBZ0IsR0FBRyxLQUFLLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FDNUMsYUFBYSxDQUFDLGlCQUFpQixDQUNoQyxDQUFDO0lBQ0YsSUFBSSxPQUFPLGdCQUFnQixLQUFLLFFBQVEsRUFBRSxDQUFDO1FBQ3pDLE1BQU0sSUFBSSxLQUFLLENBQ2IsR0FBRyxhQUFhLENBQUMsaUJBQWlCLG9DQUFvQyxDQUN2RSxDQUFDO0lBQ0osQ0FBQztJQUVELE1BQU0sV0FBVyxHQUFHLEtBQUssQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLGFBQWEsQ0FBQyxZQUFZLENBQUMsQ0FBQztJQUV0RSxJQUFJLE9BQU8sV0FBVyxLQUFLLFFBQVEsRUFBRSxDQUFDO1FBQ3BDLE1BQU0sSUFBSSxLQUFLLENBQ2IsR0FBRyxhQUFhLENBQUMsWUFBWSxvQ0FBb0MsQ0FDbEUsQ0FBQztJQUNKLENBQUM7SUFFRCxNQUFNLGNBQWMsR0FBbUIsS0FBSyxDQUFDLElBQUksQ0FBQyxVQUFVLENBQzFELGFBQWEsQ0FBQyxlQUFlLENBQzlCLENBQUM7SUFDRixNQUFNLDRCQUE0QixHQUFHLENBQUMsU0FBUyxFQUFFLFFBQVEsQ0FBQyxDQUFDO0lBRTNELElBQUksQ0FBQyw0QkFBNEIsQ0FBQyxRQUFRLENBQUMsY0FBYyxDQUFDLEVBQUUsQ0FBQztRQUMzRCxNQUFNLElBQUksS0FBSyxDQUNiLEdBQ0UsYUFBYSxDQUFDLGVBQ2hCLGlDQUFpQyw0QkFBNEIsQ0FBQyxJQUFJLENBQ2hFLElBQUksQ0FDTCxHQUFHLENBQ0wsQ0FBQztJQUNKLENBQUM7SUFFRCxPQUFPO1FBQ0wsSUFBSSxFQUFFLGNBQWM7UUFDcEIsU0FBUyxFQUFFLGdCQUFnQjtRQUMzQixJQUFJLEVBQUUsV0FBVztLQUNsQixDQUFDO0FBQ0osQ0FBQyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29uc3RydWN0IH0gZnJvbSAnY29uc3RydWN0cyc7XG5pbXBvcnQgeyBDREtDb250ZXh0S2V5IH0gZnJvbSAnQGF3cy1hbXBsaWZ5L3BsYXRmb3JtLWNvcmUnO1xuaW1wb3J0IHsgQmFja2VuZElkZW50aWZpZXIsIERlcGxveW1lbnRUeXBlIH0gZnJvbSAnQGF3cy1hbXBsaWZ5L3BsdWdpbi10eXBlcyc7XG5cbi8qKlxuICogUG9wdWxhdGVzIGEgYmFja2VuZCBpZGVudGlmaWVyIGJhc2VkIG9uIENESyBjb250ZXh0IHZhbHVlcy5cbiAqL1xuZXhwb3J0IGNvbnN0IGdldEJhY2tlbmRJZGVudGlmaWVyID0gKHNjb3BlOiBDb25zdHJ1Y3QpOiBCYWNrZW5kSWRlbnRpZmllciA9PiB7XG4gIGNvbnN0IGJhY2tlbmROYW1lc3BhY2UgPSBzY29wZS5ub2RlLmdldENvbnRleHQoXG4gICAgQ0RLQ29udGV4dEtleS5CQUNLRU5EX05BTUVTUEFDRSxcbiAgKTtcbiAgaWYgKHR5cGVvZiBiYWNrZW5kTmFtZXNwYWNlICE9PSAnc3RyaW5nJykge1xuICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgIGAke0NES0NvbnRleHRLZXkuQkFDS0VORF9OQU1FU1BBQ0V9IENESyBjb250ZXh0IHZhbHVlIGlzIG5vdCBhIHN0cmluZ2AsXG4gICAgKTtcbiAgfVxuXG4gIGNvbnN0IGJhY2tlbmROYW1lID0gc2NvcGUubm9kZS5nZXRDb250ZXh0KENES0NvbnRleHRLZXkuQkFDS0VORF9OQU1FKTtcblxuICBpZiAodHlwZW9mIGJhY2tlbmROYW1lICE9PSAnc3RyaW5nJykge1xuICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgIGAke0NES0NvbnRleHRLZXkuQkFDS0VORF9OQU1FfSBDREsgY29udGV4dCB2YWx1ZSBpcyBub3QgYSBzdHJpbmdgLFxuICAgICk7XG4gIH1cblxuICBjb25zdCBkZXBsb3ltZW50VHlwZTogRGVwbG95bWVudFR5cGUgPSBzY29wZS5ub2RlLmdldENvbnRleHQoXG4gICAgQ0RLQ29udGV4dEtleS5ERVBMT1lNRU5UX1RZUEUsXG4gICk7XG4gIGNvbnN0IGV4cGVjdGVkRGVwbG95bWVudFR5cGVWYWx1ZXMgPSBbJ3NhbmRib3gnLCAnYnJhbmNoJ107XG5cbiAgaWYgKCFleHBlY3RlZERlcGxveW1lbnRUeXBlVmFsdWVzLmluY2x1ZGVzKGRlcGxveW1lbnRUeXBlKSkge1xuICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgIGAke1xuICAgICAgICBDREtDb250ZXh0S2V5LkRFUExPWU1FTlRfVFlQRVxuICAgICAgfSBDREsgY29udGV4dCB2YWx1ZSBpcyBub3QgaW4gKCR7ZXhwZWN0ZWREZXBsb3ltZW50VHlwZVZhbHVlcy5qb2luKFxuICAgICAgICAnLCAnLFxuICAgICAgKX0pYCxcbiAgICApO1xuICB9XG5cbiAgcmV0dXJuIHtcbiAgICB0eXBlOiBkZXBsb3ltZW50VHlwZSxcbiAgICBuYW1lc3BhY2U6IGJhY2tlbmROYW1lc3BhY2UsXG4gICAgbmFtZTogYmFja2VuZE5hbWUsXG4gIH07XG59O1xuIl19