import { App } from 'aws-cdk-lib';
import { ProjectEnvironmentMainStackCreator } from './project_environment_main_stack_creator.js';
import { getBackendIdentifier } from './backend_identifier.js';
/**
 * Creates a default CDK scope for the Amplify backend to use if no scope is provided to the constructor
 */
export const createDefaultStack = (app = new App()) => {
    const mainStackCreator = new ProjectEnvironmentMainStackCreator(app, getBackendIdentifier(app));
    process.once('message', (message) => {
        if (message === 'amplifySynth') {
            app.synth({ errorOnDuplicateSynth: false });
        }
    });
    return mainStackCreator.getOrCreateMainStack();
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGVmYXVsdF9zdGFja19mYWN0b3J5LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vc3JjL2RlZmF1bHRfc3RhY2tfZmFjdG9yeS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsR0FBRyxFQUFTLE1BQU0sYUFBYSxDQUFDO0FBQ3pDLE9BQU8sRUFBRSxrQ0FBa0MsRUFBRSxNQUFNLDZDQUE2QyxDQUFDO0FBQ2pHLE9BQU8sRUFBRSxvQkFBb0IsRUFBRSxNQUFNLHlCQUF5QixDQUFDO0FBRS9EOztHQUVHO0FBQ0gsTUFBTSxDQUFDLE1BQU0sa0JBQWtCLEdBQUcsQ0FBQyxHQUFHLEdBQUcsSUFBSSxHQUFHLEVBQUUsRUFBUyxFQUFFO0lBQzNELE1BQU0sZ0JBQWdCLEdBQUcsSUFBSSxrQ0FBa0MsQ0FDN0QsR0FBRyxFQUNILG9CQUFvQixDQUFDLEdBQUcsQ0FBQyxDQUMxQixDQUFDO0lBQ0YsT0FBTyxDQUFDLElBQUksQ0FBQyxTQUFTLEVBQUUsQ0FBQyxPQUFPLEVBQUUsRUFBRTtRQUNsQyxJQUFJLE9BQU8sS0FBSyxjQUFjLEVBQUUsQ0FBQztZQUMvQixHQUFHLENBQUMsS0FBSyxDQUFDLEVBQUUscUJBQXFCLEVBQUUsS0FBSyxFQUFFLENBQUMsQ0FBQztRQUM5QyxDQUFDO0lBQ0gsQ0FBQyxDQUFDLENBQUM7SUFDSCxPQUFPLGdCQUFnQixDQUFDLG9CQUFvQixFQUFFLENBQUM7QUFDakQsQ0FBQyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXBwLCBTdGFjayB9IGZyb20gJ2F3cy1jZGstbGliJztcbmltcG9ydCB7IFByb2plY3RFbnZpcm9ubWVudE1haW5TdGFja0NyZWF0b3IgfSBmcm9tICcuL3Byb2plY3RfZW52aXJvbm1lbnRfbWFpbl9zdGFja19jcmVhdG9yLmpzJztcbmltcG9ydCB7IGdldEJhY2tlbmRJZGVudGlmaWVyIH0gZnJvbSAnLi9iYWNrZW5kX2lkZW50aWZpZXIuanMnO1xuXG4vKipcbiAqIENyZWF0ZXMgYSBkZWZhdWx0IENESyBzY29wZSBmb3IgdGhlIEFtcGxpZnkgYmFja2VuZCB0byB1c2UgaWYgbm8gc2NvcGUgaXMgcHJvdmlkZWQgdG8gdGhlIGNvbnN0cnVjdG9yXG4gKi9cbmV4cG9ydCBjb25zdCBjcmVhdGVEZWZhdWx0U3RhY2sgPSAoYXBwID0gbmV3IEFwcCgpKTogU3RhY2sgPT4ge1xuICBjb25zdCBtYWluU3RhY2tDcmVhdG9yID0gbmV3IFByb2plY3RFbnZpcm9ubWVudE1haW5TdGFja0NyZWF0b3IoXG4gICAgYXBwLFxuICAgIGdldEJhY2tlbmRJZGVudGlmaWVyKGFwcCksXG4gICk7XG4gIHByb2Nlc3Mub25jZSgnbWVzc2FnZScsIChtZXNzYWdlKSA9PiB7XG4gICAgaWYgKG1lc3NhZ2UgPT09ICdhbXBsaWZ5U3ludGgnKSB7XG4gICAgICBhcHAuc3ludGgoeyBlcnJvck9uRHVwbGljYXRlU3ludGg6IGZhbHNlIH0pO1xuICAgIH1cbiAgfSk7XG4gIHJldHVybiBtYWluU3RhY2tDcmVhdG9yLmdldE9yQ3JlYXRlTWFpblN0YWNrKCk7XG59O1xuIl19