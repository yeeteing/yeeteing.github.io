"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.defaultCliUserAgent = defaultCliUserAgent;
const path = require("path");
const util_1 = require("./util");
const util_2 = require("../../util");
/**
 * Find the package.json from the main toolkit.
 *
 * If we can't read it for some reason, try to do something reasonable anyway.
 * Fall back to argv[1], or a standard string if that is undefined for some reason.
 */
function defaultCliUserAgent() {
    const root = (0, util_2.bundledPackageRootDir)(__dirname, false);
    const pkg = JSON.parse((root ? (0, util_1.readIfPossible)(path.join(root, 'package.json')) : undefined) ?? '{}');
    const name = pkg.name ?? path.basename(process.argv[1] ?? 'cdk-cli');
    const version = pkg.version ?? '<unknown>';
    return `${name}/${version}`;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidXNlci1hZ2VudC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbInVzZXItYWdlbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFTQSxrREFNQztBQWZELDZCQUE2QjtBQUM3QixpQ0FBd0M7QUFDeEMscUNBQW1EO0FBQ25EOzs7OztHQUtHO0FBQ0gsU0FBZ0IsbUJBQW1CO0lBQ2pDLE1BQU0sSUFBSSxHQUFHLElBQUEsNEJBQXFCLEVBQUMsU0FBUyxFQUFFLEtBQUssQ0FBQyxDQUFDO0lBQ3JELE1BQU0sR0FBRyxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLElBQUEscUJBQWMsRUFBQyxJQUFJLENBQUMsSUFBSSxDQUFDLElBQUksRUFBRSxjQUFjLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxTQUFTLENBQUMsSUFBSSxJQUFJLENBQUMsQ0FBQztJQUNyRyxNQUFNLElBQUksR0FBRyxHQUFHLENBQUMsSUFBSSxJQUFJLElBQUksQ0FBQyxRQUFRLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsSUFBSSxTQUFTLENBQUMsQ0FBQztJQUNyRSxNQUFNLE9BQU8sR0FBRyxHQUFHLENBQUMsT0FBTyxJQUFJLFdBQVcsQ0FBQztJQUMzQyxPQUFPLEdBQUcsSUFBSSxJQUFJLE9BQU8sRUFBRSxDQUFDO0FBQzlCLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgKiBhcyBwYXRoIGZyb20gJ3BhdGgnO1xuaW1wb3J0IHsgcmVhZElmUG9zc2libGUgfSBmcm9tICcuL3V0aWwnO1xuaW1wb3J0IHsgYnVuZGxlZFBhY2thZ2VSb290RGlyIH0gZnJvbSAnLi4vLi4vdXRpbCc7XG4vKipcbiAqIEZpbmQgdGhlIHBhY2thZ2UuanNvbiBmcm9tIHRoZSBtYWluIHRvb2xraXQuXG4gKlxuICogSWYgd2UgY2FuJ3QgcmVhZCBpdCBmb3Igc29tZSByZWFzb24sIHRyeSB0byBkbyBzb21ldGhpbmcgcmVhc29uYWJsZSBhbnl3YXkuXG4gKiBGYWxsIGJhY2sgdG8gYXJndlsxXSwgb3IgYSBzdGFuZGFyZCBzdHJpbmcgaWYgdGhhdCBpcyB1bmRlZmluZWQgZm9yIHNvbWUgcmVhc29uLlxuICovXG5leHBvcnQgZnVuY3Rpb24gZGVmYXVsdENsaVVzZXJBZ2VudCgpIHtcbiAgY29uc3Qgcm9vdCA9IGJ1bmRsZWRQYWNrYWdlUm9vdERpcihfX2Rpcm5hbWUsIGZhbHNlKTtcbiAgY29uc3QgcGtnID0gSlNPTi5wYXJzZSgocm9vdCA/IHJlYWRJZlBvc3NpYmxlKHBhdGguam9pbihyb290LCAncGFja2FnZS5qc29uJykpIDogdW5kZWZpbmVkKSA/PyAne30nKTtcbiAgY29uc3QgbmFtZSA9IHBrZy5uYW1lID8/IHBhdGguYmFzZW5hbWUocHJvY2Vzcy5hcmd2WzFdID8/ICdjZGstY2xpJyk7XG4gIGNvbnN0IHZlcnNpb24gPSBwa2cudmVyc2lvbiA/PyAnPHVua25vd24+JztcbiAgcmV0dXJuIGAke25hbWV9LyR7dmVyc2lvbn1gO1xufVxuIl19